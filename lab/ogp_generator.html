<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OGPÁîªÂÉè„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº | Kagetica Lab</title>
    <meta property="og:title" content="OGPÁîªÂÉè„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº | Kagetica Lab">
    <meta property="og:description" content="„ÉÜ„Ç≠„Çπ„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Éá„Ç∂„Ç§„É≥„ÇíÈÅ∏„Å∂„Å†„Åë„ÄÇ900Á®Æ„ÅÆ„Éá„Ç∂„Ç§„É≥„Åã„ÇâÊ¥óÁ∑¥„Åï„Çå„ÅüOGPÁîªÂÉè„ÇíÂç≥Â∫ß„Å´ÁîüÊàê„ÄÇ">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://kagetica.net/lab/ogp_generator.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@kagetica">
    <link rel="icon" href="../assets/icon.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&family=Playfair+Display:wght@400;700;900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        gothic: ['"Noto Sans JP"', 'sans-serif'],
                        inter: ['"Inter"', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    }
                }
            }
        }
    </script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        body {
            background-color: var(--bg-color)
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 3px solid #000;
            box-shadow: 10px 10px 0 #000
        }

        body.sf-mode .glass-panel {
            background: rgba(0, 0, 0, 0.8);
            border-color: var(--matrix);
            box-shadow: 0 0 15px var(--matrix);
            color: var(--matrix)
        }

        .preview-canvas-wrapper {
            position: relative;
            background: repeating-conic-gradient(#e0e0e0 0% 25%, #fff 0% 50%) 50%/16px 16px;
            border-radius: 8px;
            overflow: hidden
        }

        .dc {
            transition: all .12s ease;
            cursor: pointer;
            border: 2px solid transparent;
            border-radius: 6px;
            overflow: hidden
        }

        .dc:hover {
            transform: scale(1.04);
            border-color: rgba(0, 0, 0, 0.2)
        }

        .dc.sel {
            outline: 3px solid #000;
            outline-offset: 1px
        }

        body.sf-mode .dc.sel {
            outline-color: var(--matrix)
        }

        .tt {
            transition: all .12s ease
        }

        .tt.on {
            background: #000;
            color: #fff
        }

        body.sf-mode .tt.on {
            background: var(--matrix);
            color: #000
        }

        .dg::-webkit-scrollbar {
            width: 4px
        }

        .dg::-webkit-scrollbar-track {
            background: transparent
        }

        .dg::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 2px
        }
    </style>
</head>

<body class="loading">
    <canvas id="matrix-canvas"></canvas>
    <div class="sf-toggle" id="sf-toggle"><span class="sf-toggle-icon">SF</span></div>
    <nav id="nav">
        <div class="nav-container">
            <a href="../index.html" class="logo-mark"><img src="../assets/icon.png" alt="Kagetica Icon"></a>
            <div class="nav-links">
                <a href="../index.html" class="vertical-text">Top</a>
                <a href="../profile.html" class="vertical-text">Profile</a>
                <a href="../news.html" class="vertical-text">News</a>
                <a href="../works.html" class="vertical-text active">Works</a>
                <a href="../schedule.html" class="vertical-text">Schedule</a>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdXy8Z_p6V_h1B4Zc6mX7VfW6zY8v-J5z1zQ8P_z6-lq6q9g/viewform"
                    target="_blank" class="vertical-text">Contact</a>
            </div>
        </div>
    </nav>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // ================================================================
        //  900Á®Æ„Éá„Ç∂„Ç§„É≥ = 30„Éë„É¨„ÉÉ„Éà √ó 6„É¨„Ç§„Ç¢„Ç¶„Éà √ó 5Ë£ÖÈ£æ
        // ================================================================

        // ‚îÄ‚îÄ 30 „Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà ‚îÄ‚îÄ
        const PAL = [
            // „Éü„Éã„Éû„É´ 0-5
            { t: 'minimal', n: 'White', bg: ['#fff'], tc: '#111', sc: '#555', lc: '#999' },
            { t: 'minimal', n: 'Ink', bg: ['#0a0a0a'], tc: '#fff', sc: '#aaa', lc: '#666' },
            { t: 'minimal', n: 'Paper', bg: ['#f5f0e8'], tc: '#2c2420', sc: '#6b5d52', lc: '#9c8d80' },
            { t: 'minimal', n: 'Slate', bg: ['#e8eaed'], tc: '#202124', sc: '#5f6368', lc: '#9aa0a6' },
            { t: 'minimal', n: 'Cream', bg: ['#faf8f5'], tc: '#1a1a1a', sc: '#555', lc: '#999' },
            { t: 'minimal', n: 'Snow', bg: ['#f0f2f5'], tc: '#1a1a2e', sc: '#4a4a5a', lc: '#8a8a9a' },
            // „Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ 6-13
            { t: 'gradient', n: 'Violet', bg: ['#0f0c29', '#302b63', '#24243e'], tc: '#fff', sc: '#c5c3ff', lc: '#8a88cc' },
            { t: 'gradient', n: 'Coral', bg: ['#ff416c', '#ff4b2b'], tc: '#fff', sc: '#fff0e0', lc: '#ffd0b0' },
            { t: 'gradient', n: 'Emerald', bg: ['#11998e', '#38ef7d'], tc: '#fff', sc: '#d0fff0', lc: '#90ddc0' },
            { t: 'gradient', n: 'Cotton', bg: ['#fc5c7d', '#6a82fb'], tc: '#fff', sc: '#f3e5f5', lc: '#d1c4e9' },
            { t: 'gradient', n: 'Ocean', bg: ['#141E30', '#243B55'], tc: '#e0f0ff', sc: '#80b0d0', lc: '#5a8aa8' },
            { t: 'gradient', n: 'Gold', bg: ['#f7971e', '#ffd200'], tc: '#1a1a2e', sc: '#3d2e00', lc: '#6b5a20' },
            { t: 'gradient', n: 'Prism', bg: ['#833ab4', '#fd1d1d', '#fcb045'], tc: '#fff', sc: '#fce4ec', lc: '#f8bbd0' },
            { t: 'gradient', n: 'Aurora', bg: ['#0f2027', '#203a43', '#2c5364'], tc: '#e0f7fa', sc: '#80cbc4', lc: '#4db6ac' },
            // „ÉÄ„Éº„ÇØ 14-19
            { t: 'dark', n: 'Noir', bg: ['#1a1a2e'], tc: '#e94560', sc: '#eaeaea', lc: '#8a8a9a' },
            { t: 'dark', n: 'GitHub', bg: ['#0d1117'], tc: '#58a6ff', sc: '#c9d1d9', lc: '#8b949e' },
            { t: 'dark', n: 'Dracula', bg: ['#282a36'], tc: '#f8f8f2', sc: '#bd93f9', lc: '#6272a4' },
            { t: 'dark', n: 'Terminal', bg: ['#0c0c0c'], tc: '#00ff41', sc: '#00cc33', lc: '#008822' },
            { t: 'dark', n: 'Charcoal', bg: ['#232526', '#414345'], tc: '#e0e0e0', sc: '#bdbdbd', lc: '#757575' },
            { t: 'dark', n: 'MidGold', bg: ['#0a0a23'], tc: '#ffc300', sc: '#f0f0f0', lc: '#888' },
            // „Éë„Çπ„ÉÜ„É´ 20-24
            { t: 'pastel', n: 'Peach', bg: ['#ffecd2', '#fcb69f'], tc: '#3e2723', sc: '#5d4037', lc: '#8d6e63' },
            { t: 'pastel', n: 'Sky', bg: ['#a1c4fd', '#c2e9fb'], tc: '#1a237e', sc: '#283593', lc: '#5c6bc0' },
            { t: 'pastel', n: 'Lavender', bg: ['#fbc2eb', '#a6c1ee'], tc: '#311b92', sc: '#4527a0', lc: '#7e57c2' },
            { t: 'pastel', n: 'Lime', bg: ['#d4fc79', '#96e6a1'], tc: '#1b5e20', sc: '#33691e', lc: '#558b2f' },
            { t: 'pastel', n: 'Mist', bg: ['#fff1eb', '#ace0f9'], tc: '#1a1a2e', sc: '#455a64', lc: '#78909c' },
            // „Éú„Éº„É´„Éâ 25-29
            { t: 'bold', n: 'Ruby', bg: ['#c62828'], tc: '#fff', sc: '#ffcdd2', lc: '#ef9a9a' },
            { t: 'bold', n: 'Electric', bg: ['#0d47a1'], tc: '#fff', sc: '#bbdefb', lc: '#64b5f6' },
            { t: 'bold', n: 'Cyber', bg: ['#ffd600'], tc: '#000', sc: '#333', lc: '#666' },
            { t: 'bold', n: 'Forest', bg: ['#1b5e20'], tc: '#fff', sc: '#c8e6c9', lc: '#81c784' },
            { t: 'bold', n: 'Purple', bg: ['#4a148c'], tc: '#fff', sc: '#e1bee7', lc: '#ce93d8' },
        ];

        // ‚îÄ‚îÄ 6 „É¨„Ç§„Ç¢„Ç¶„Éà ‚îÄ‚îÄ
        // ÂêÑ„É¨„Ç§„Ç¢„Ç¶„Éà„ÅØ (ctx, w, h, pal, texts) => void
        const LAYOUTS = [
            // 0: Â∑¶ÊèÉ„Åà„Éª‰∏≠Â§ÆÈÖçÁΩÆ
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'left';
                const x = w * 0.08, mw = w * 0.84;
                _drawTexts(ctx, tx, p, x, mw, 'left', h * 0.5, h);
            },
            // 1: ‰∏≠Â§ÆÊèÉ„Åà
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'center';
                _drawTexts(ctx, tx, p, w * 0.5, w * 0.8, 'center', h * 0.5, h);
            },
            // 2: Âè≥ÊèÉ„Åà
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'right';
                _drawTexts(ctx, tx, p, w * 0.92, w * 0.84, 'right', h * 0.5, h);
            },
            // 3: Â∑¶‰∏ãÈÖçÁΩÆ
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'left';
                _drawTexts(ctx, tx, p, w * 0.08, w * 0.84, 'left', h * 0.78, h);
            },
            // 4: Â∑¶‰∏äÈÖçÁΩÆ
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'left';
                _drawTexts(ctx, tx, p, w * 0.08, w * 0.84, 'left', h * 0.28, h);
            },
            // 5: ‰∏≠Â§ÆÂ§ßÔºà„Çø„Ç§„Éà„É´Â∑®Â§ßÔºâ
            (ctx, w, h, p, tx) => {
                ctx.textAlign = 'center';
                _drawTexts(ctx, tx, p, w * 0.5, w * 0.85, 'center', h * 0.5, h, 1.4);
            },
        ];

        // „ÉÜ„Ç≠„Çπ„ÉàÊèèÁîª„Éò„É´„Éë„Éº
        function _drawTexts(ctx, tx, p, anchorX, maxW, align, centerY, h, titleScale = 1) {
            const { title, subtitle, logline } = tx;
            const hasT = title && title.trim(), hasS = subtitle && subtitle.trim(), hasL = logline && logline.trim();
            const ff = '"Noto Sans JP","Inter",sans-serif';
            const gap = h * 0.04;

            let tSz = Math.floor(h * 0.12 * titleScale);
            ctx.font = `900 ${tSz}px ${ff}`;
            while (hasT && ctx.measureText(title).width > maxW && tSz > 18) { tSz -= 2; ctx.font = `900 ${tSz}px ${ff}`; }
            const sSz = Math.floor(h * 0.048), lSz = Math.floor(h * 0.035);

            let bH = 0;
            if (hasT) bH += tSz;
            if (hasS) bH += sSz + gap;
            if (hasL) bH += lSz + gap * 0.8;

            let y = centerY - bH / 2;
            ctx.textBaseline = 'middle';
            ctx.textAlign = align;

            if (hasT) {
                ctx.font = `900 ${tSz}px ${ff}`;
                ctx.fillStyle = p.tc;
                ctx.fillText(title, anchorX, y + tSz / 2);
                y += tSz + gap;
            }
            if (hasS) {
                let fs = sSz;
                ctx.font = `600 ${fs}px ${ff}`;
                while (ctx.measureText(subtitle).width > maxW && fs > 12) { fs--; ctx.font = `600 ${fs}px ${ff}`; }
                ctx.fillStyle = p.sc;
                ctx.fillText(subtitle, anchorX, y + fs / 2);
                y += fs + gap * 0.8;
            }
            if (hasL) {
                let fs = lSz;
                ctx.font = `400 ${fs}px ${ff}`;
                while (ctx.measureText(logline).width > maxW && fs > 10) { fs--; ctx.font = `400 ${fs}px ${ff}`; }
                ctx.fillStyle = p.lc;
                ctx.fillText(logline, anchorX, y + fs / 2);
            }
        }

        // ‚îÄ‚îÄ 5 Ë£ÖÈ£æ„Éë„Çø„Éº„É≥ ‚îÄ‚îÄ
        const DEC = [
            // 0: „Å™„Åó
            (ctx, w, h, p) => { },
            // 1: Âπæ‰ΩïÂ≠¶„Ç™„Éº„Éê„Éº„É¨„Ç§ÔºàÂÜÜÔºãÁ∑öÔºâ
            (ctx, w, h, p) => {
                ctx.save();
                ctx.fillStyle = p.tc; ctx.globalAlpha = 0.04;
                ctx.beginPath(); ctx.arc(w * 0.88, h * 0.2, w * 0.15, 0, Math.PI * 2); ctx.fill();
                ctx.beginPath(); ctx.arc(w * 0.1, h * 0.82, w * 0.08, 0, Math.PI * 2); ctx.fill();
                ctx.fillStyle = p.tc; ctx.globalAlpha = 0.08;
                ctx.fillRect(w * 0.08, h * 0.85, w * 0.12, 3);
                ctx.restore();
            },
            // 2: „Éï„É¨„Éº„É†Ôºã„Ç≥„Éº„Éä„Éº
            (ctx, w, h, p) => {
                ctx.save();
                ctx.strokeStyle = p.tc; ctx.globalAlpha = 0.1; ctx.lineWidth = 2;
                const m = w * 0.05;
                ctx.beginPath(); ctx.roundRect(m, m, w - m * 2, h - m * 2, 4); ctx.stroke();
                // „Ç≥„Éº„Éä„Éº„Ç¢„ÇØ„Çª„É≥„Éà
                ctx.fillStyle = p.tc; ctx.globalAlpha = 0.15;
                const cs = w * 0.025;
                ctx.fillRect(m - 1, m - 1, cs, 3); ctx.fillRect(m - 1, m - 1, 3, cs);
                ctx.fillRect(w - m - cs + 1, m - 1, cs, 3); ctx.fillRect(w - m - 1, m - 1, 3, cs);
                ctx.fillRect(m - 1, h - m - 2, cs, 3); ctx.fillRect(m - 1, h - m - cs + 1, 3, cs);
                ctx.fillRect(w - m - cs + 1, h - m - 2, cs, 3); ctx.fillRect(w - m - 1, h - m - cs + 1, 3, cs);
                ctx.restore();
            },
            // 3: „Éâ„ÉÉ„ÉàÔºã„Çπ„Éà„É©„Ç§„Éó
            (ctx, w, h, p) => {
                ctx.save();
                ctx.fillStyle = p.tc; ctx.globalAlpha = 0.03;
                const sp = w * 0.04;
                for (let x = sp; x < w; x += sp)for (let y = sp; y < h; y += sp) { ctx.beginPath(); ctx.arc(x, y, 1.5, 0, Math.PI * 2); ctx.fill(); }
                ctx.globalAlpha = 0.06;
                ctx.fillRect(0, 0, w, 4); ctx.fillRect(0, h - 4, w, 4);
                ctx.restore();
            },
            // 4: „Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥„Ç™„Éº„Éê„Éº„É¨„Ç§ÔºãÂÖ≠ËßíÂΩ¢
            (ctx, w, h, p) => {
                ctx.save();
                // ‰∏ãÈÉ®„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥
                const g = ctx.createLinearGradient(0, h * 0.75, 0, h);
                g.addColorStop(0, 'transparent'); g.addColorStop(1, p.tc);
                ctx.fillStyle = g; ctx.globalAlpha = 0.06;
                ctx.fillRect(0, h * 0.75, w, h * 0.25);
                // ÂÖ≠ËßíÂΩ¢
                ctx.strokeStyle = p.tc; ctx.globalAlpha = 0.06; ctx.lineWidth = 1.5;
                const cx = w * 0.88, cy = h * 0.22, r = w * 0.06;
                ctx.beginPath();
                for (let i = 0; i < 6; i++) { const a = Math.PI / 3 * i - Math.PI / 6; ctx.lineTo(cx + r * Math.cos(a), cy + r * Math.sin(a)); }
                ctx.closePath(); ctx.stroke();
                ctx.restore();
            },
        ];

        // „ÉÜ„Éº„Éû
        const THEMES = [
            { id: 'all', label: '„Åô„Åπ„Å¶' },
            { id: 'minimal', label: '„Éü„Éã„Éû„É´' },
            { id: 'gradient', label: '„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥' },
            { id: 'dark', label: '„ÉÄ„Éº„ÇØ' },
            { id: 'pastel', label: '„Éë„Çπ„ÉÜ„É´' },
            { id: 'bold', label: '„Éú„Éº„É´„Éâ' },
        ];

        // „É¨„Ç§„Ç¢„Ç¶„Éà„É©„Éô„É´
        const LAY_LABELS = ['Â∑¶ÊèÉ„Åà', '‰∏≠Â§ÆÊèÉ„Åà', 'Âè≥ÊèÉ„Åà', 'Â∑¶‰∏ã', 'Â∑¶‰∏ä', 'Â§ßÊñáÂ≠ó‰∏≠Â§Æ'];

        // ÂÖ®900„Éá„Ç∂„Ç§„É≥ÁîüÊàê: palette(30) √ó layout(6) √ó decor(5) = 900
        const ALL = [];
        for (let pi = 0; pi < PAL.length; pi++) {
            for (let li = 0; li < LAYOUTS.length; li++) {
                for (let di = 0; di < DEC.length; di++) {
                    ALL.push({
                        id: pi * 30 + li * 5 + di,
                        pi, li, di,
                        theme: PAL[pi].t,
                        name: `${PAL[pi].n} ¬∑ ${LAY_LABELS[li].charAt(0)}${di + 1}`,
                    });
                }
            }
        }

        const SIZES = [
            { id: '16:9', label: '16:9', desc: 'YouTubeÁ≠â', width: 1280, height: 720 },
            { id: '5:2', label: '5:2', desc: 'XË®ò‰∫ã', width: 1200, height: 480 },
            { id: 'ogp', label: '1.91:1', desc: 'OGPÊ®ôÊ∫ñ', width: 1200, height: 630 },
        ];

        // CanvasÊèèÁîª
        function drawOGP(canvas, opts) {
            const { design, title, subtitle, logline, size, customImage, imagePos } = opts;
            const ctx = canvas.getContext('2d');
            const w = size.width, h = size.height;
            canvas.width = w; canvas.height = h;
            const p = PAL[design.pi];

            // ËÉåÊôØ
            if (p.bg.length === 1) { ctx.fillStyle = p.bg[0]; ctx.fillRect(0, 0, w, h); }
            else { const g = ctx.createLinearGradient(0, 0, w, h); p.bg.forEach((c, i) => g.addColorStop(i / (p.bg.length - 1), c)); ctx.fillStyle = g; ctx.fillRect(0, 0, w, h); }

            // „Ç´„Çπ„Çø„É†ÁîªÂÉèÈÖçÁΩÆ (ËÉåÊôØ)
            if (customImage && imagePos === 'bg') {
                ctx.save();
                ctx.globalAlpha = 0.4;
                const imgRatio = customImage.width / customImage.height;
                const canvasRatio = w / h;
                let dw = w, dh = h;
                if (imgRatio > canvasRatio) {
                    dw = h * imgRatio;
                    ctx.drawImage(customImage, (w - dw) / 2, 0, dw, dh);
                } else {
                    dh = w / imgRatio;
                    ctx.drawImage(customImage, 0, (h - dh) / 2, dw, dh);
                }
                ctx.restore();

                // „Ç™„Éº„Éê„Éº„É¨„Ç§ (Ë¶ñË™çÊÄßÁ¢∫‰øù)
                ctx.save();
                ctx.globalAlpha = 0.5;
                ctx.fillStyle = p.bg.length === 1 ? p.bg[0] : p.bg[0];
                ctx.fillRect(0, 0, w, h);
                ctx.restore();
            }

            // Ë£ÖÈ£æ
            ctx.save(); DEC[design.di](ctx, w, h, p); ctx.restore();

            // „Ç´„Çπ„Çø„É†ÁîªÂÉèÈÖçÁΩÆ („Åù„ÅÆ‰ªñ)
            if (customImage && imagePos !== 'bg') {
                ctx.save();
                let targetW, targetH, x, y;
                const imgRatio = customImage.width / customImage.height;

                if (imagePos === 'right') {
                    targetW = w * 0.35;
                    targetH = targetW / imgRatio;
                    if (targetH > h * 0.7) {
                        targetH = h * 0.7;
                        targetW = targetH * imgRatio;
                    }
                    x = w * 0.92 - targetW;
                    y = (h - targetH) / 2;

                    // „Ç∑„É£„Éâ„Ç¶
                    ctx.shadowColor = 'rgba(0,0,0,0.15)';
                    ctx.shadowBlur = 30;
                    ctx.shadowOffsetY = 15;
                } else if (imagePos === 'logo-br') {
                    targetW = w * 0.12;
                    targetH = targetW / imgRatio;
                    if (targetH > h * 0.15) {
                        targetH = h * 0.15;
                        targetW = targetH * imgRatio;
                    }
                    x = w * 0.95 - targetW;
                    y = h * 0.92 - targetH;
                } else if (imagePos === 'logo-tl') {
                    targetW = w * 0.12;
                    targetH = targetW / imgRatio;
                    if (targetH > h * 0.15) {
                        targetH = h * 0.15;
                        targetW = targetH * imgRatio;
                    }
                    x = w * 0.05;
                    y = h * 0.08;
                }

                // Ëßí‰∏∏„ÇØ„É™„ÉÉ„ÉóÔºàrightÈÖçÁΩÆ„ÅÆ„ÅøÔºâ
                if (imagePos === 'right') {
                    const rad = Math.min(20, targetW / 4);
                    ctx.beginPath();
                    ctx.moveTo(x + rad, y);
                    ctx.lineTo(x + targetW - rad, y);
                    ctx.quadraticCurveTo(x + targetW, y, x + targetW, y + rad);
                    ctx.lineTo(x + targetW, y + targetH - rad);
                    ctx.quadraticCurveTo(x + targetW, y + targetH, x + targetW - rad, y + targetH);
                    ctx.lineTo(x + rad, y + targetH);
                    ctx.quadraticCurveTo(x, y + targetH, x, y + targetH - rad);
                    ctx.lineTo(x, y + rad);
                    ctx.quadraticCurveTo(x, y, x + rad, y);
                    ctx.closePath();
                    ctx.clip();
                }

                ctx.drawImage(customImage, x, y, targetW, targetH);
                ctx.restore();
            }

            // „É¨„Ç§„Ç¢„Ç¶„ÉàÔºà„ÉÜ„Ç≠„Çπ„ÉàÊèèÁîªÔºâ
            ctx.save(); LAYOUTS[design.li](ctx, w, h, p, { title, subtitle, logline }); ctx.restore();
        }

        // ===== „É°„Ç§„É≥„Ç¢„Éó„É™ =====
        function App() {
            const canvasRef = useRef(null);
            const [title, setTitle] = useState('„Çµ„Éº„Éì„ÇπÂêç');
            const [subtitle, setSubtitle] = useState('„Ç≠„É£„ÉÉ„ÉÅ„Ç≥„Éî„Éº„Çí„Åì„Åì„Å´');
            const [logline, setLogline] = useState('„ÅÇ„Å™„Åü„ÅÆÊó•Â∏∏„Çí„ÇÇ„Å£„Å®‰æøÂà©„Å´„ÄÅ„ÇÇ„Å£„Å®Ê•Ω„Åó„Åè„ÄÇ');
            const [selId, setSelId] = useState(0);
            const [selSize, setSelSize] = useState(SIZES[2]);
            const [selTheme, setSelTheme] = useState('all');
            const [page, setPage] = useState(0);
            const [scale, setScale] = useState(1);
            const [customImage, setCustomImage] = useState(null);
            const [imagePos, setImagePos] = useState('right');
            const wrapRef = useRef(null);

            const design = ALL[selId] || ALL[0];
            const PS = 60;

            const filtered = useMemo(() => {
                if (selTheme === 'all') return ALL;
                return ALL.filter(d => d.theme === selTheme);
            }, [selTheme]);

            const paged = useMemo(() => filtered.slice(page * PS, (page + 1) * PS), [filtered, page]);
            const totalP = Math.ceil(filtered.length / PS);

            useEffect(() => {
                const u = () => { if (wrapRef.current) setScale(Math.min(1, wrapRef.current.offsetWidth / selSize.width)); };
                u(); window.addEventListener('resize', u); return () => window.removeEventListener('resize', u);
            }, [selSize]);

            useEffect(() => {
                if (!canvasRef.current) return;
                drawOGP(canvasRef.current, { design, title, subtitle, logline, size: selSize, customImage, imagePos });
            }, [design, title, subtitle, logline, selSize, customImage, imagePos]);

            const handleImageUpload = useCallback((e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => setCustomImage(img);
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }, []);

            const download = useCallback(() => {
                if (!canvasRef.current) return;
                const a = document.createElement('a');
                a.download = `ogp_${selSize.id.replace(':', 'x')}_${Date.now()}.png`;
                a.href = canvasRef.current.toDataURL('image/png');
                a.click();
            }, [selSize]);

            const randomize = useCallback(() => {
                const pool = selTheme === 'all' ? ALL : ALL.filter(d => d.theme === selTheme);
                const r = pool[Math.floor(Math.random() * pool.length)];
                setSelId(r.id);
                const idx = filtered.findIndex(d => d.id === r.id);
                if (idx >= 0) setPage(Math.floor(idx / PS));
            }, [selTheme, filtered]);

            const changeTheme = useCallback((t) => { setSelTheme(t); setPage(0); }, []);

            const Mini = React.memo(({ d, sel, onClick }) => {
                const ref = useRef(null);
                useEffect(() => {
                    if (!ref.current) return;
                    drawOGP(ref.current, { design: d, title: 'Title', subtitle: 'Sub', logline: '', size: { width: 192, height: 101 } });
                }, [d]);
                return <div onClick={onClick} className={`dc ${sel ? 'sel' : ''}`}><canvas ref={ref} className="w-full h-auto block" /></div>;
            });

            return (
                <main className="min-h-screen">
                    <header className="subpage-header">
                        <div className="container">
                            <h1 className="subpage-title">OGPÁîªÂÉè„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº</h1>
                            <p className="mt-4 font-gothic opacity-70">„ÉÜ„Ç≠„Çπ„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Éá„Ç∂„Ç§„É≥„ÇíÈÅ∏„Å∂„Å†„Åë„ÄÇ900Á®Æ„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Åã„ÇâÊ¥óÁ∑¥„Åï„Çå„Åü„Çµ„É†„Éç„Ç§„É´„ÇíÁû¨ÊôÇ„Å´ÁîüÊàê„ÄÇ</p>
                        </div>
                    </header>
                    <section className="section pb-20" style={{ paddingTop: 0 }}>
                        <div className="container">
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                {/* „Éó„É¨„Éì„É•„Éº */}
                                <div className="space-y-6">
                                    <div className="glass-panel p-6">
                                        <div className="flex justify-between items-center mb-4">
                                            <span className="font-mono text-xs tracking-widest uppercase opacity-50">Preview</span>
                                            <div className="flex gap-2">
                                                <button onClick={randomize} className="text-xs font-bold px-4 py-2 border-2 border-black text-black hover:bg-black hover:text-white transition-all rounded-lg" style={{ borderColor: 'currentColor' }}>üé≤ „É©„É≥„ÉÄ„É†</button>
                                                <button onClick={download} className="text-xs font-bold px-4 py-2 bg-black text-white hover:bg-gray-800 transition-all rounded-lg">‚¨á PNG</button>
                                            </div>
                                        </div>
                                        <div ref={wrapRef} className="preview-canvas-wrapper">
                                            <canvas ref={canvasRef} style={{ width: selSize.width * scale, height: selSize.height * scale, display: 'block' }} />
                                        </div>
                                        <div className="flex justify-between items-center mt-3">
                                            <span className="text-[10px] opacity-40 font-mono">{selSize.width}√ó{selSize.height}px</span>
                                            <span className="text-[10px] opacity-40 font-mono">#{design.id} {design.name}</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Ë®≠ÂÆö */}
                                <div className="space-y-6">
                                    {/* „ÉÜ„Ç≠„Çπ„Éà */}
                                    <div className="glass-panel p-6">
                                        <h3 className="font-mono text-sm tracking-widest border-b border-black mb-5 pb-2" style={{ borderColor: 'currentColor' }}>TEXT</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-[10px] font-bold opacity-50 uppercase tracking-wider block mb-1">„Çø„Ç§„Éà„É´</label>
                                                <input type="text" value={title} onChange={e => setTitle(e.target.value)} className="w-full p-3 border-2 border-gray-300 rounded-lg font-bold text-lg focus:outline-none focus:border-black transition-colors" placeholder="„Çµ„Éº„Éì„ÇπÂêç" />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold opacity-50 uppercase tracking-wider block mb-1">„Çµ„Éñ„Çø„Ç§„Éà„É´ / „Ç≠„É£„ÉÉ„ÉÅ„Ç≥„Éî„Éº</label>
                                                <input type="text" value={subtitle} onChange={e => setSubtitle(e.target.value)} className="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-black transition-colors font-bold" placeholder="„Ç≠„É£„ÉÉ„ÉÅ„Ç≥„Éî„Éº" />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold opacity-50 uppercase tracking-wider block mb-1">„É≠„Ç∞„É©„Ç§„É≥ / Ë™¨ÊòéÊñá</label>
                                                <input type="text" value={logline} onChange={e => setLogline(e.target.value)} className="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-black transition-colors text-sm" placeholder="„Çµ„Éº„Éì„Çπ„ÅÆÊ¶ÇË¶ÅÔºà‰ªªÊÑèÔºâ" />
                                            </div>
                                        </div>
                                    </div>

                                    {/* „Ç´„Çπ„Çø„É†ÁîªÂÉè */}
                                    <div className="glass-panel p-6">
                                        <h3 className="font-mono text-sm tracking-widest border-b border-black mb-4 pb-2" style={{ borderColor: 'currentColor' }}>CUSTOM IMAGE</h3>
                                        <div className="space-y-4">
                                            <div className="flex gap-2 items-center">
                                                <label className="flex-1 cursor-pointer bg-white border-2 border-gray-300 hover:border-black rounded-lg p-3 text-center text-sm font-bold transition-colors">
                                                    {customImage ? 'ÁîªÂÉè„ÇíÂ§âÊõ¥' : 'ÁîªÂÉè„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ'}
                                                    <input type="file" accept="image/*" onChange={handleImageUpload} className="hidden" />
                                                </label>
                                                {customImage && (
                                                    <button onClick={() => setCustomImage(null)} className="p-3 border-2 border-gray-300 hover:border-red-500 text-red-500 rounded-lg font-bold text-sm transition-colors">
                                                        ÂâäÈô§
                                                    </button>
                                                )}
                                            </div>
                                            {customImage && (
                                                <div>
                                                    <label className="text-[10px] font-bold opacity-50 uppercase tracking-wider block mb-2 mt-2">ÈÖçÁΩÆ„Çπ„Çø„Ç§„É´</label>
                                                    <div className="grid grid-cols-2 lg:grid-cols-4 gap-2">
                                                        {[
                                                            { id: 'bg', label: 'ËÉåÊôØ' },
                                                            { id: 'right', label: 'Âè≥ÂÅ¥' },
                                                            { id: 'logo-br', label: 'Âè≥‰∏ã„É≠„Ç¥' },
                                                            { id: 'logo-tl', label: 'Â∑¶‰∏ä„É≠„Ç¥' }
                                                        ].map(pos => (
                                                            <button key={pos.id} onClick={() => setImagePos(pos.id)} className={`px-2 py-2 text-[11px] font-bold border-2 rounded-lg transition-colors ${imagePos === pos.id ? 'bg-black text-white border-black' : 'bg-white text-gray-700 border-gray-300 hover:border-black'}`}>
                                                                {pos.label}
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>

                                    {/* „Çµ„Ç§„Ç∫ */}
                                    <div className="glass-panel p-6">
                                        <h3 className="font-mono text-sm tracking-widest border-b border-black mb-4 pb-2" style={{ borderColor: 'currentColor' }}>SIZE</h3>
                                        <div className="grid grid-cols-3 gap-2">
                                            {SIZES.map(sz => (
                                                <button key={sz.id} onClick={() => setSelSize(sz)} className={`p-3 rounded-lg text-center transition-all border-2 ${selSize.id === sz.id ? 'bg-black text-white border-black' : 'bg-white text-gray-700 border-gray-300 hover:border-black'}`}>
                                                    <div className="text-sm font-black">{sz.label}</div>
                                                    <div className="text-[10px] opacity-60 mt-0.5">{sz.desc}</div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* „Éá„Ç∂„Ç§„É≥ */}
                                    <div className="glass-panel p-6">
                                        <h3 className="font-mono text-sm tracking-widest border-b border-black mb-4 pb-2" style={{ borderColor: 'currentColor' }}>
                                            DESIGN <span className="text-[10px] ml-2 opacity-40">{filtered.length}Á®Æ</span>
                                        </h3>
                                        <div className="flex flex-wrap gap-1.5 mb-4">
                                            {THEMES.map(t => (
                                                <button key={t.id} onClick={() => changeTheme(t.id)} className={`tt px-3 py-1.5 rounded-full text-[11px] font-bold border border-gray-300 ${selTheme === t.id ? 'on' : 'hover:bg-gray-100'}`}>{t.label}</button>
                                            ))}
                                        </div>
                                        <div className="grid grid-cols-4 sm:grid-cols-5 gap-2 max-h-[320px] overflow-y-auto pr-1 dg">
                                            {paged.map(d => (
                                                <Mini key={d.id} d={d} sel={selId === d.id} onClick={() => setSelId(d.id)} />
                                            ))}
                                        </div>
                                        {totalP > 1 && (
                                            <div className="flex items-center justify-center gap-2 mt-4">
                                                <button onClick={() => setPage(Math.max(0, page - 1))} disabled={page === 0} className="text-xs font-bold px-3 py-1.5 border border-gray-300 rounded-lg disabled:opacity-30 hover:bg-gray-100 transition-colors">‚Üê Ââç</button>
                                                <span className="text-[11px] font-mono opacity-50">{page + 1} / {totalP}</span>
                                                <button onClick={() => setPage(Math.min(totalP - 1, page + 1))} disabled={page >= totalP - 1} className="text-xs font-bold px-3 py-1.5 border border-gray-300 rounded-lg disabled:opacity-30 hover:bg-gray-100 transition-colors">Ê¨° ‚Üí</button>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </main>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <footer class="footer">
        <div class="container">
            <div class="copyright">&copy; 2026 Yoshida Kagetica</div>
        </div>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="../js/main.js"></script>
</body>

</html>